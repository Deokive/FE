import barcode from "@/assets/icon/bar.svg";
import { formatDate } from "./DiaryCard";
import clsx from "clsx";

interface TicketCardProps {
  id?: number;
  title?: string;
  date?: string;
  thumbnail?: string | null;
  onClick?: () => void;
  className?: string;
}

const TicketCard = ({
  title,
  date,
  thumbnail,
  onClick,
  className,
}: TicketCardProps) => {
  return (
    <div
      onClick={onClick}
      className={clsx(
        "relative w-[360px] h-[360px] cursor-pointer overflow-hidden rounded-xl",
        className
      )}
      aria-hidden={false}
    >
      {/* 티켓 배경 SVG */}
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="360"
        height="360"
        viewBox="0 0 360 360"
        fill="none"
        className="absolute inset-0"
      >
        <path
          d="M358.438 2.90933C359.463 3.75214 360.001 4.6991 360 5.66168V207.326C359.995 208.507 359.179 209.657 357.666 210.617C356.152 211.578 354.016 212.301 351.555 212.686C346.528 213.478 342.17 214.961 339.087 216.927C336.003 218.893 334.346 221.246 334.346 223.659C334.346 226.071 336.003 228.424 339.087 230.39C342.17 232.357 346.528 233.839 351.555 234.632C354.016 235.017 356.152 235.74 357.666 236.7C359.179 237.661 359.995 238.811 360 239.991V354.315C360.001 355.062 359.678 355.801 359.048 356.49C358.419 357.18 357.496 357.807 356.332 358.335C355.169 358.863 353.787 359.281 352.266 359.567C350.745 359.853 349.114 360 347.468 360H12.5324C10.8859 360 9.25549 359.853 7.73447 359.567C6.21344 359.281 4.83151 358.863 3.66766 358.335C2.50381 357.807 1.5809 357.18 0.951599 356.49C0.322296 355.801 -0.00109863 355.062 0 354.315V240.01C0.00500488 238.83 0.820984 237.68 2.33441 236.719C3.84784 235.759 5.98352 235.036 8.44495 234.651C13.4718 233.858 17.8296 232.376 20.9134 230.41C23.9973 228.443 25.6541 226.09 25.6541 223.678C25.6541 221.265 23.9973 218.913 20.9134 216.946C17.8296 214.98 13.4718 213.498 8.44495 212.705C5.98352 212.32 3.84784 211.597 2.33441 210.637C0.820984 209.676 0.00500488 208.526 0 207.346V5.68082C-0.00109863 4.93466 0.322266 4.19574 0.951691 3.50629C1.58112 2.81683 2.50421 2.19037 3.66815 1.66278C4.83209 1.13516 6.21408 0.716736 7.73508 0.431427C9.25607 0.146118 10.8863 -0.000488281 12.5324 3.05176e-05H347.468C349.702 -0.00201416 351.897 0.266571 353.826 0.778076C355.755 1.28955 357.347 2.02536 358.438 2.90933ZM41.8532 222.704C41.4286 222.702 41.0123 222.757 40.6579 222.863C40.3036 222.969 40.0273 223.121 39.8648 223.299C39.7022 223.477 39.6607 223.673 39.7457 223.861C39.8307 224.05 40.0382 224.223 40.3416 224.357C40.746 224.536 41.2883 224.636 41.8532 224.637H66.6476C67.0712 224.638 67.4857 224.582 67.8387 224.475C68.1917 224.369 68.4671 224.218 68.63 224.041C68.7929 223.864 68.836 223.668 68.7537 223.48C68.6714 223.292 68.4674 223.119 68.1678 222.983C67.7612 222.803 67.2155 222.703 66.6476 222.704H41.8532ZM84.3314 222.704C83.9078 222.703 83.4932 222.759 83.1402 222.865C82.7873 222.971 82.5118 223.122 82.3489 223.3C82.186 223.477 82.143 223.672 82.2253 223.86C82.3076 224.049 82.5116 224.222 82.8113 224.357C83.2188 224.536 83.7639 224.637 84.3314 224.637H109.126C109.549 224.638 109.964 224.582 110.317 224.475C110.67 224.369 110.945 224.218 111.108 224.041C111.271 223.864 111.314 223.668 111.232 223.48C111.149 223.292 110.945 223.119 110.646 222.983C110.239 222.803 109.694 222.703 109.126 222.704H84.3314ZM126.809 222.704C126.518 222.695 126.226 222.714 125.952 222.759C125.677 222.804 125.425 222.874 125.213 222.964C125 223.055 124.83 223.164 124.714 223.286C124.598 223.407 124.539 223.538 124.539 223.67C124.539 223.803 124.598 223.933 124.714 224.055C124.83 224.176 125 224.286 125.213 224.376C125.425 224.467 125.677 224.537 125.952 224.581C126.226 224.626 126.518 224.645 126.809 224.637H151.638C152.059 224.636 152.471 224.579 152.822 224.472C153.172 224.366 153.445 224.215 153.608 224.038C153.77 223.862 153.814 223.668 153.734 223.48C153.654 223.292 153.453 223.119 153.158 222.983C152.751 222.803 152.205 222.703 151.638 222.704H126.809ZM169.279 222.704C168.988 222.695 168.696 222.714 168.421 222.759C168.147 222.804 167.895 222.874 167.682 222.964C167.47 223.055 167.3 223.164 167.184 223.286C167.068 223.407 167.008 223.538 167.008 223.67C167.008 223.803 167.068 223.933 167.184 224.055C167.3 224.176 167.47 224.286 167.682 224.376C167.895 224.467 168.147 224.537 168.421 224.581C168.696 224.626 168.988 224.645 169.279 224.637H194.09C194.511 224.635 194.922 224.577 195.271 224.471C195.62 224.364 195.892 224.213 196.054 224.037C196.215 223.86 196.258 223.666 196.178 223.479C196.097 223.292 195.897 223.119 195.602 222.983C195.198 222.804 194.655 222.704 194.09 222.704H169.279ZM211.757 222.704C211.477 222.703 211.199 222.728 210.94 222.776C210.681 222.824 210.446 222.895 210.247 222.985C210.048 223.074 209.891 223.181 209.784 223.298C209.676 223.416 209.621 223.541 209.621 223.668C209.619 223.926 209.841 224.173 210.237 224.357C210.646 224.536 211.19 224.636 211.757 224.637H236.552C236.975 224.638 237.39 224.582 237.743 224.475C238.096 224.369 238.371 224.218 238.534 224.041C238.697 223.864 238.74 223.668 238.658 223.48C238.575 223.292 238.371 223.119 238.072 222.983C237.666 222.803 237.12 222.703 236.552 222.704H211.757ZM254.235 222.704C253.811 222.702 253.395 222.757 253.04 222.863C252.686 222.969 252.41 223.121 252.247 223.299C252.084 223.477 252.043 223.673 252.128 223.861C252.213 224.05 252.42 224.223 252.724 224.357C253.128 224.536 253.67 224.636 254.235 224.637H279.03C279.453 224.638 279.868 224.582 280.221 224.475C280.574 224.369 280.849 224.218 281.012 224.041C281.175 223.864 281.218 223.668 281.136 223.48C281.053 223.292 280.85 223.119 280.55 222.983C280.143 222.803 279.598 222.703 279.03 222.704H254.235ZM296.714 222.704C296.433 222.703 296.155 222.728 295.895 222.776C295.636 222.824 295.399 222.895 295.2 222.985C295.001 223.074 294.843 223.181 294.734 223.298C294.626 223.415 294.57 223.541 294.569 223.668C294.566 223.796 294.62 223.923 294.727 224.041C294.834 224.159 294.992 224.267 295.192 224.357C295.392 224.447 295.629 224.518 295.891 224.566C296.152 224.614 296.432 224.638 296.714 224.637H321.508C321.799 224.645 322.091 224.626 322.366 224.581C322.64 224.537 322.892 224.467 323.105 224.376C323.317 224.286 323.487 224.176 323.603 224.055C323.719 223.933 323.779 223.803 323.779 223.67C323.779 223.538 323.719 223.407 323.603 223.286C323.487 223.164 323.317 223.055 323.105 222.964C322.892 222.874 322.64 222.804 322.366 222.759C322.091 222.714 321.799 222.695 321.508 222.704H296.714Z"
          fill="#D5E8F9"
        />
      </svg>
      {/* 티켓 내용 영역 */}
      <div className="absolute inset-0 flex flex-col pt-9 px-8 gap-[51px] z-10">
        {/* 제목 박스: 내부에 섬네일 배경 레이어를 두어 제목 부분에만 배경 적용 */}
        <div className="relative h-[153px] rounded-xl overflow-hidden">
          {thumbnail ? (
            // 썸네일이 있을 때: 배경 이미지(블러+밝기 보정) + 반투명 오버레이 + 텍스트
            <>
              <div
                aria-hidden="true"
                className="absolute inset-0"
                style={{
                  backgroundImage: `url(${thumbnail})`,
                  backgroundSize: "cover",
                  backgroundPosition: "center",
                  transform: "scale(1.06)",
                  filter: "blur(2px) brightness(0.65)",
                }}
              />
              {/* 가독성 보강을 위한 반투명 오버레이 */}
              <div
                aria-hidden="true"
                className="absolute inset-0"
                style={{ backgroundColor: "rgba(0,0,0,0.22)" }}
              />
              {/* 텍스트는 상대 위치로 위에 올림 */}
              <div className="relative z-10 flex items-center justify-center h-full p-2.5">
                <p className="typo-h2-semibold text-color-lowest text-center break-words px-2">
                  {title ?? "티켓 이름"}
                </p>
              </div>
            </>
          ) : (
            // 썸네일이 없을 때: 기존 회색 박스 형태 그대로 출력
            <div className="relative w-full h-full flex items-center justify-center p-2.5 rounded-xl bg-[#808080]">
              <p className="typo-h2-semibold text-color-lowest text-center break-words px-2">
                {title ?? "티켓 이름"}
              </p>
            </div>
          )}
        </div>

        {/* 하단 바코드 + 날짜 */}
        <div className="flex flex-col gap-[7px] items-center">
          <img src={barcode} alt="barcode" className="w-50 h-18" />
          {date ? (
            <p className="typo-h3 text-color-high">{formatDate(date)}</p>
          ) : (
            <p className="typo-h3 text-color-high">yyyy.mm.dd</p>
          )}
        </div>
      </div>
    </div>
  );
};
export default TicketCard;
